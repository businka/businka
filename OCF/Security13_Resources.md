# 13 Ресурсы безопасности

## 13.1 Ресурсы по безопасности Общие

Ресурсы безопасности OCF показаны на рисунке 34.
Ресурс и свойства «/oic/sec/cred» показаны на рисунке 35. 
Ресурс и свойства «/oic/sec/acl2» показаны на рисунке 36.
Ресурс и свойства «/oic/sec/amacl» показаны на рисунке 37. 
Ресурс и свойства «/oic/sec/sacl» показаны на рисунке 38.

![Ресурсы безопасности OCF](.\figure\sec034.png)
Рисунок 34. Ресурсы безопасности OCF
![Рисунок 35. Ресурс и свойства «/oic/sec/cred».](.\figure\sec035.png)
Рисунок 35. Ресурс и свойства «/oic/sec/cred».
![Рисунок 36. Ресурс и свойства «/oic/sec/acl2»](.\figure\sec036.png)
Рисунок 36. Ресурс и свойства «/oic/sec/acl2».
![Рисунок 37. Ресурс и свойства «/oic/sec/amacl»](.\figure\sec037.png)
Рисунок 37. Ресурс и свойства «/oic/sec/amacl». 
![Рисунок 38. Ресурс и свойства «/oic/sec/sacl»](.\figure\sec038.png)

###### Рисунок 38. Ресурс и свойства «/oic/sec/sacl».

## 13.2 Ресурс передачи владельца устройства

### 13.2.1 Ресурс передачи владельца устройства Общие

Ресурс "/oic/sec/doxm" содержит набор поддерживаемых OTM устройств.

Обработка обнаружения ресурсов учитывает ограничения CRUDN, предоставленные как часть определений ресурсов безопасности, содержащихся в этом документе.
Ресурс "/oic/sec/doxm" определен в таблице 24.

###### Таблица 24 - Определение ресурса «/oic/sec/doxm»

| **Fixed  URI** | **Resource  Type Title** | **Resource Type ID ("rt"  value)** | **OCF Interfaces** | **Description**                                | **Related** Functional Interaction |
| -------------- | ------------------------ | ---------------------------------- | ------------------ | ---------------------------------------------- | ---------------------------------- |
| /oic/sec/doxm  | Device OTMs              | oic.r.doxm                         | oic.if.baseline    | Resource  for supporting Device owner transfer | Configuration                      |

Таблица 25 определяет свойства ресурса «/oic/sec/doxm».

###### Таблица 25 - Свойства ресурса "/oic/sec/doxm"

| **Property Title**         | **Property Name** | **Value  Type**   | **Value  Rule**  | **Mand atory** | **Device State** | **Access Mode** | **Description**                                              |
| -------------------------- | ----------------- | ----------------- | ---------------- | -------------- | ---------------- | --------------- | ------------------------------------------------------------ |
| OTM                        | oxms              | oic.sec. doxmtype | array            | Yes            |                  | R               | Значение, определяющее метод передачи владельца и организацию, которая определила метод. |
| OTM Selection              | oxmsel            | oic.sec. doxmtype | UINT 16          | Yes            | RESET            | R               | Сервер должен установить (4) "oic.sec.oxm.self"              |
|                            |                   |                   |                  |                | RFOTM            | RW              | DOTS устанавливает выбранные DOTS, и обе стороны выполняют DOTS. После того, как безопасный сеанс передачи владельца установлен, DOTS должен снова обновить oxmsel, делая его постоянным. Если DOTS выходит из строя, состояние устройства передачи данных на сервере равно RESET. |
|                            |                   |                   |                  |                | RFPRO            | R               | n /a                                                         |
|                            |                   |                   |                  |                | RFNOP            | R               | n /a                                                         |
|                            |                   |                   |                  |                | SRESET           | R               | n /a                                                         |
| Supported Credential Types | sct               | oic.sec. credtype | bitmask          | Yes            |                  | R               | Определяет типы учетных данных, которые поддерживает Устройство. Сервер устанавливает это значение при инициализации платформы после определения возможностей безопасности. |
| Device  Ownership Status   | owned             | Boolean           | T \|F            | Yes            | RESET            | R               | Сервер должен быть установлен на ЛОЖЬ.                       |
|                            |                   |                   |                  |                | RFOTM            | RW              | DOTS должен быть установлен в TRUE после того, как будет установлен безопасный сеанс передачи владельца. |
|                            |                   |                   |                  |                | RFPRO            | R               | n /a                                                         |
|                            |                   |                   |                  |                | RFNOP            | R               | n /a                                                         |
|                            |                   |                   |                  |                | SRESET           | R               | n /a                                                         |
| Device  UUID               | deviceuuid        | String            | oic.sec. didtype | Yes            | RESET            | R               | Сервер должен создать временный случайный UUID, который будет отличаться для каждого перехода к RESET. |
|                            |                   |                   |                  |                | RFOTM            | RW              | DOTS должна обновиться до значения, которое она выбрала после установления безопасного сеанса передачи владельца. Если обновление завершается ошибкой PROPERTY_NOT_FOUND, DOTS должны либо принять значение, предоставленное Сервером, либо update / doxm.owned = FALSE, и завершить сеанс. |
|                            |                   |                   |                  |                | RFPRO            | R               | n /a                                                         |
|                            |                   |                   |                  |                | RFNOP            | R               | n /a                                                         |
|                            |                   |                   |                  |                | SRESET           | R               | n /a                                                         |
| Device  Owner Id           | devowneruuid      | String            | uuid             | Yes            | RESET            | R               | Сервер должен установить нулевое значение uuid (например, «00000000-0000-0000-0000-000000000000») |
|                            |                   |                   |                  |                | RFOTM            | RW              | DOTS устанавливает значение после установления безопасного сеанса передачи владельца. |
|                            |                   |                   |                  |                | RFPRO            | R               | n /a                                                         |
|                            |                   |                   |                  |                | RFNOP            | R               | n /a                                                         |
|                            |                   |                   |                  |                | SRESET           | R               | n /a                                                         |
| Resource Owner  Id         | rowneruuid        | String            | uuid             | Yes            | RESET            | R               | Сервер должен установить нулевое значение uuid (например, «00000000-0000-0000-0000-000000000000») |
|                            |                   |                   |                  |                | RFOTM            | RW              | DOTS должна настроить свойство rowneruuid, когда установлен успешный сеанс передачи владельца. |
|                            |                   |                   |                  |                | RFPRO            | R               | n /a                                                         |
|                            |                   |                   |                  |                | RFNOP            | R               | n /a                                                         |
|                            |                   |                   |                  |                | SRESET           | RW              | DOTS (указанная в свойстве devowneruuid) должна проверять и, при необходимости, обновлять свойство владельца ресурса при установке защищенного сеанса с взаимной аутентификацией. Если rowneruuid не относится к действительному идентификатору устройства DOTS, Сервер полностью переходит в состояние СБРОС устройства. |

Свойство oxms содержит список OTM, в котором элементы расположены в порядке предпочтения.
Это Свойство содержит методы с более высоким приоритетом, которые появляются перед методами с более низким приоритетом.
DOTS запрашивает этот список во время адаптации и выбирает наиболее подходящий метод.
DOTS обновляет свойство oxmsel ресурса "/oic/sec/doxm" с помощью OTM, который использовался для подключения устройства.
OTM состоят из двух частей: URI, идентифицирующего поставщика или организацию, и конкретного метода.

```
<DoxmType> ::= <NSS>
<NSS> ::= <Identifier> | {{<NID>"."} <NameSpaceQualifier> "."} <Method>
<NID> :: = <Vendor-or-Organization>
<Identifier> ::= INTEGER
<NameSpaceQualifier> ::= String
<Method> ::= String
<Vendor-Organization> ::= String
```

Когда OTM успешно завершается, собственное свойство устанавливается в «1» (ИСТИНА). Следовательно, последующие попытки стать владельцем Устройства потерпят неудачу.

Сервер должен предоставлять постоянное или полупостоянное Свойство deviceuuid, которое хранится в Ресурсе «/oic/sec/doxm», когда Свойство devowneruuid ресурса «/oic/sec/doxm» ОБНОВЛЯЕТСЯ до ненулевого UUID.

DOTS должны ПОЛУЧИТЬ обновленное свойство deviceuuid ресурса "/oic/sec/doxm" после обновления значения свойства devowneruuid ресурса "/oic/sec/doxm" до значения UUID, отличного от нуля.
Поставщик устройства должен определить, является ли идентификатор устройства (devic euuid) постоянным (не обновляемым) или непостоянным (обновляемым службой передачи владельца - также известной как DOTS).
Если свойство deviceuuid ресурса «/oic/sec/doxm» является постоянным, запрос на UPDATE завершится ошибкой PROPERTY_NOT_FOUND.
Если свойство deviceuuid ресурса "/oic/sec/doxm" непостоянно, запрос UPDATE должен быть успешным, и значение, предоставленное DOTS, должно запоминаться до тех пор, пока устройство не перейдет в состояние RESET. Если UPDATE для свойства deviceuuid ресурса «/oic/sec/doxm» завершается неудачно в состоянии устройства RFOTM, состояние устройства должно перейти в состояние RESET, где сервер должен установить значение свойства devic euuid для «/oic/sec/doxm "Восстановите нулевой UUID (например," 00000000-0000-0000-0000-000000000000 ").
Независимо от того, имеет ли устройство постоянное или полупостоянное свойство deviceuuid ресурса «/oic/sec/doxm», временный случайный UUID предоставляется сервером через свойство deviceuuid ресурса «/oic/». sec / doxm "Ресурс каждый раз, когда устройство сбрасывает статус устройства. Временное значение deviceuuid используется, когда устройство находится в состоянии RESET и в состоянии устройства RFOTM, пока DOTS не устанавливает безопасное соединение OTM. DOTS должны ПОЛУЧИТЬ обновленное значение свойства deviceuuid ресурса "/oic/sec/doxm" после того, как они обновили значение свойства devowneruuid ресурса "/oic/sec/doxm" до значения UUID, отличного от нуля.
Свойство deviceuuid ресурса «/oic/sec/doxm» должно предоставлять постоянное значение (т. Е. Не обновляется через интерфейс OCF) или как постоянное значение (т. Е. Обновляется с помощью DOTS через интерфейс OCF). to the deviceuuid Свойство ресурса "/oic/sec/doxm" во время состояния устройства RFOTM.).
Это временное неповторяющееся значение должно предоставляться Устройством до тех пор, пока DOTS не установит безопасное соединение OTM и не ОБНОВИТ свойство devowneruuid до значения UUID, отличного от нуля. Впоследствии (в статусах RFPRO, RFNOP и SRESET Device) свойство deviceuuid ресурса «/oic/sec/doxm» должно раскрывать постоянное или полупостоянное значение для аутентифицированных запрашивающих лиц и должно показывать временное непостоянное значение. -повторяющееся значение для неаутентифицированных запрашивающих.
См. 13.16 для получения дополнительных сведений о соображениях конфиденциальности.

### 13.2.2 Постоянные и полупостоянные идентификаторы устройств

Производитель устройства определяет, может ли идентификатор устройства быть установлен с помощью инструмента конфигурации или он является неизменным. Если это неизменное значение, этот документ называет его постоянным
идентификатор устройства. В противном случае он называется полупостоянным идентификатором устройства. Есть четыре идентификатора устройств, которые можно считать постоянными или полупостоянными:
1) "deviceuuid" Свойство "/oic/sec/doxm"
2) "di" Свойство "/oic/d"
3) "piid" Свойство "/oic/d"
4) "pi" Свойство "/oic/p"

### 13.2.3 Рекомендации по подключению идентификатора устройства

Deviceuuid используется для подключения к Устройству. Остальные идентификаторы (di, piid и pi) не важны для подключения. Служба подключения (также известная как DOTS) может априори не знать, использует ли устройство, которое будет подключено, постоянные или полупостоянные идентификаторы. Владелец домена безопасности OCF может предпочитать постоянные или полупостоянные идентификаторы устройств.
Определить, использует ли Устройство постоянный или полупостоянный идентификатор устройства, можно попытаться обновить его.

Если свойство «deviceuuid» ресурса «/oic/sec/doxm» является постоянным, то запрос UPDATE в подходящее время во время подключения должен завершиться ошибкой с соответствующим ответом об ошибке.
Подходящее время для попытки обновить deviceuuid во время подключения существует, когда состояние устройства - RFOTM и когда значение свойства devowneruuid ресурса «/oic/sec/doxm» имеет значение UUID, отличное от нуля.
Если свойство «deviceuuid» ресурса «/oic/sec/doxm» является полупостоянным, после успешного запроса UPDATE на его изменение; Устройство должно запоминать полупостоянное значение до следующего успешного запроса UPDATE или до тех пор, пока состояние устройства не перейдет в состояние RESET.
См. 13. 16 для дополнительной информации относительно "deviceuuid".

### 13.2.4 OTM, определенные OCF

В таблице 27 определены свойства типа «oic.sec.doxmtype».

###### Таблица 27 - Свойства свойства "oic.sec.doxmtype"

| **Value  Type Name**             | **Value Type URN (optional)** | **Enumeration Value** **(mandatory)** | **Description**                                              |
| -------------------------------- | ----------------------------- | ------------------------------------- | ------------------------------------------------------------ |
| OCFJustWorks                     | oic.sec. doxm.jw              | 0                                     | Метод  just-works основан на протоколе согласования несимметричных ключей  Диффи-Хеллмана, позволяющем DOTS утверждать право собственности на новое  Устройство. Первым DOTS, создавшим подтверждение, является владелец  устройства.  Он  просто работает с результатами в специальном секрете, который используется  для аутентификации Устройства в DOTS и, соответственно, аутентификации DOTS в  Устройстве. Устройство позволяет DOTS взять на себя управление устройством,  после чего вторая попытка стать владельцем другой DOTS потерпит неудачу.     Метод  «просто работает» уязвим для атак типа «человек посередине». При  использовании этого метода следует принять меры для обеспечения физической  безопасности. |
| OCFSharedPin                     | oic.sec. doxm.rdp             | 1                                     | Новое  Устройство случайным образом генерирует PIN-код, который передается по внеполосному  каналу в DOTS.  Межполосный  протокол согласования ключей Диффи-Хеллмана устанавливает, что обе конечные  точки используют PIN-код.  Обладание  PIN-кодом DOTS сигнализирует новому Устройству о том, что право владения  устройством может быть подтверждено. |
| OCFMfgCert                       | oic.sec. doxm. mfgcert        | 2                                     | Предполагается,  что новое Устройство было изготовлено со встроенным асимметричным закрытым  ключом, который используется для подписи биржи Диффи-Хеллмана при подключении  устройства. Сертификат производителя должен содержать информацию об усилении  защиты платформы и другие утверждения о гарантиях безопасности. |
| OCFReserved                      | Reserved                      | 3                                     | Зарезервированный                                            |
| OCFSelf                          | oic.sec. oxm.self             | 4                                     | Изготовитель  должен установить значение / doxm.oxmsel равным (4). Сервер должен сбросить  это значение на (4) при входе в состояние СБРОС устройства. |
| OCFReserved                      | Reserved                      | 5 ~ 0xFEFF                            | Зарезервировано для  использования OCF                       |
| Vendor-defined V alue  Type Name | Reserved                      | 0 x FF00~ 0xFFFF                      | Зарезервировано для  использования OTM в зависимости от поставщика |

## 13.3 Ресурс учетных данных

### 13.3. 1 Общие сведения о личном ресурсе

Ресурс «/oiс/sec/cred» поддерживает учетные данные, используемые для аутентификации Сервера для клиентов и служб поддержки, а также учетные данные, используемые для проверки клиентов и служб поддержки.
Фреймворк OCF предполагает наличие нескольких типов учетных данных, включая парные предварительно общие ключи, асимметричные ключи, сертификаты и другие. Ресурс учетных данных использует UUID Субъекта, чтобы различать клиентов и службы поддержки, которые он распознает путем проверки аутентификации.

Чтобы предоставить интерфейс, который позволяет управлять свойством массива "creds", операции RETRIEVE, UPDATE и DELETE на Ресурсе "oic.r.cred" должны вести себя следующим образом:

1. RETRIEVE должен вернуть полное представление ресурса, за исключением того, что любые свойства только для записи должны быть опущены (например, данные закрытого ключа).
2. ОБНОВЛЕНИЕ заменяет или добавляет свойства, включенные в представление, отправленное с запросом ОБНОВЛЕНИЕ, следующим образом:
   1. Если представление UPDATE включает свойство массива "creds", то:
      1. Поставляемые кредиты с «кредитным идентификатором», который соответствует существующему «кредитному идентификатору», должны полностью заменить соответствующие кредиты в существующем массиве «кредитов».
      2. Поставляемые кредиты без "credid" должны быть добавлены к существующему массиву "credid", и уникальный (для ресурса credid) должен быть создан и назначен серверу для нового кредита. «Кредит» удаленного кредита не должен использоваться повторно, чтобы улучшить детерминизм интерфейса и уменьшить возможность возникновения состояний гонки.
      3. Поставляемые кредиты с «кредитным идентификатором», который не соответствует существующему «кредитному идентификатору», должны быть добавлены к существующему массиву «кредитов» с использованием предоставленного «кредитного идентификатора».
      4. Строки в Таблице 29, соответствующие Свойству массива "creds", определяют Статусы устройства, в которых ОБНОВЛЕНИЕ свойства массива "creds" всегда отклоняется. Если Устройство OCF находится в Состоянии Устройства, где Режим доступа в этой строке продолжает «R», то зал Устройства OCF отклоняет все ОБНОВЛЕНИЯ свойства массива «creds».
3. УДАЛЕНИЕ без параметров запроса удаляет весь массив "creds", но не удаляет ресурс "oic.r.cred".
4. DELETE с одним или несколькими параметрами запроса "credid" удаляет кредит (-ы) с соответствующим (-ми) кредитом (-ами) из массива "creds".
5. Строки в Таблице 29, соответствующие свойству массива "creds", определяют Статусы устройства, в которых DELE TE всегда отклоняется. Если Устройство OCF находится в Состоянии Устройства, где Режим доступа в этой строке содержит "R", тогда Устройство OCF должно отклонить все УДАЛЕНИЯ.

ПРИМЕЧАНИЕ Использование ресурса «oic.r.cred» операции DELETE не связано с интерфейсами OCF, определенными в ISO / IEC 30118-1:2018.
Ресурс "oic.r.cred" определен в Таблице 28.

###### Таблица 28 - Определение ресурса "oic.r.cred"

| **Fixed URI** | **Resource Type Title** | **Resource  Type ID (" rt" value )** | **OCF Inte****rfaces** | **Description**                                              | **Related** **Func** **tiona****l** **Interaction** |
| ------------- | ----------------------- | ------------------------------------ | ---------------------- | ------------------------------------------------------------ | --------------------------------------------------- |
| /oic/sec/cred | Credentials             | oic.r.cred                           | baseline               | Re  so u rce containing cre d e ntials for Device authentication, verificatio n a  n d d ata protection | Security                                            |

Таблица 29 определяет свойства ресурса «/oiс/sec/cred».

###### Таблица 29 - Свойства ресурса "/oiс/sec/cred"

| **Property Title** | Property Name | *Value Type** | **Value Rule** | **Mand atory** | **Device State** | **Access Mode** | **Description**                                              |
| ------------------ | ------------- | ------------- | -------------- | -------------- | ---------------- | --------------- | ------------------------------------------------------------ |
| Credentials        | creds         | oic.sec. cred | array          | Yes            | RESET            | R               | Сервер должен установить заводские настройки по умолчанию    |
|                    |               |               |                |                | RFOTM            | RW              | S et by DOTS a fter su c  cessf ul OTM                       |
|                    |               |               |                |                | RFPRO            | RW              | S  e t b y the CMS (referenced via the ro wn e  ruuid P roperty  of "/ oic/se c/  cred" Re so u rce) after  successful authentication. Access to NCRs is prohibited. |
|                    |               |               |                |                | RNOP             | R               | A  cce ss to NCRs i s p ermitted after a m a t chin g ACE is found. |
|                    |               |               |                |                | SRESET           | RW              | Точки DOTS (на которые есть ссылка в свойстве devowneruuid ресурса / oic / sec / doxm или в свойстве rown e ruuid ресурса / oic / sec / doxm) должны оценивать целостность и могут обновлять записи кредитов, когда безопасный сеанс установлен, и Сервер и DOTS повторно аутентифицированы.. |
| Resource Owner ID  | rowneruuid    | String        | uuid           | Yes            | RESET            | R               | S  e rve r shall se t to the nil uuid value (e. g. "00000000-0000-0000-0000  -0 0 0 000000 000" ) |
|                    |               |               |                |                | RFOTM            | RW              | T  he DOTS shall configure the rown e ruuid P roperty  of "/ oic/se c/  cred" Re so u rce when a  su ccessful o wner t ra n sfer se ssio n is established. |
|                    |               |               |                |                | RFPRO            | R               | n /a                                                         |
|                    |               |               |                |                | RFNOP            | R               | n /a                                                         |
|                    |               |               |                |                | SRESET           | RW              | Точки DOTS (указанные через свойство devowneruuid ресурса / oic / sec / doxm "или свойство rowneruuid ресурса" / o ic / sec / doxm ") должны проверять и при необходимости обновлять Свойство владельца ресурса при взаимной аутентификации безопасный сеанс установлен.Если свойство rowneruuid не относится к действующим точкам DOTS, Сервер должен перейти в состояние устройства RESE T.. |

Все безопасные доступы к Устройству должны иметь ресурс «/oiс/sec/cred», который защищает сквозное взаимодействие.

Ресурс «/oiс/sec/cred» должен обновляться службой, указанной в его свойстве rowneruuid.

Ресурс ACL с именами "/oiс/sec/cred" должен дополнительно ограничивать доступ за пределами режимов доступа CRUDN.
В таблице 30 определены свойства «oic.sec.cred».

###### Таблица 30 - Свойства свойства "oic.sec.cred"

Таблица 31 определяет свойства «oic.sec.credusagetype».

###### Таблица 31: Свойства свойства "oic.sec.credusagetype"



Таблица 33 определяет свойства «oic.sec.privdatatype».

###### Таблица 33 - Свойства свойства "oic.sec.privdatatype"

### 13.3.2 Свойства ресурса учетных данных

#### 13.3.2.1 Идентификатор учетных данных

Идентификатор учетных данных (credid) - это локальная ссылка на запись в массиве свойств creds ресурса "/oiс/sec/cred". SRM его генерирует. Свойство credid должно использоваться для устранения неоднозначности элементов массива в Свойстве credid.

#### 13.3.2.2 UUID субъекта

Свойство subjectuuid идентифицирует Устройство, для которого должна использоваться запись в массиве свойств creds ресурса «/oiс/sec/cred» для установления защищенного сеанса, проверки подлинности запроса-ответа или для аутентификации запроса аутентификации.
Свойство subjectuuid, которое соответствует собственному свойству сервера deviceuuid, отличает записи массива в свойстве creds, относящиеся к этому Устройству.
Свойство subjectuuid должно использоваться для идентификации группы, для которой используется групповой ключ для защиты совместно используемых данных.


Когда сертификат используется во время установления безопасного соединения, свойство «subjectuuid» также должно использоваться для проверки личности ответчика. Настоящий сертификат должен быть принят, если на Устройстве имеется соответствующая учетная запись, которая удовлетворяет всем следующим требованиям:
- Публичные данные записи содержат якорь доверия (корень) представленной цепочки.
- UUID субъекта записи совпадает с UUID в поле Common Name сертификата конечного объекта в представленной цепочке. Если Subj ect UUID записи установлен как подстановочный знак «*», это условие автоматически выполняется.
- Использование учетных данных для записи: «oic.sec.cred.trustca».

#### 13.3.2.3 ID роли

Свойство roleid определяет роль, которая была предоставлена учетным данным.

#### 13.3.2.4 Тип учетных данных

Свойство credtype используется для интерпретации нескольких других значений свойств, значения которых могут различаться в зависимости от типа учетных данных. Эти свойства включают общедоступные, частные и необязательные данные. Значение свойства credtype, равное «0» («без режима безопасности»), зарезервировано для условий тестирования и отладки. Производственные развертывания не должны допускать предоставление учетных данных типа «0». В SRM следует ввести код проверки, который предотвращает его использование в производственных развертываниях.

#### 13.3.2.5 Общедоступные данные

Publicdat a Property содержит информацию, которая обеспечивает дополнительный контекст, окружающий выдачу учетных данных. Например, он может содержать информацию, включенную в сертификат, или данные ответа от CMS. Он может содержать обернутые данные.

#### 13.3.2.6 Личные данные

Свойство приватных данных содержит секретную информацию, которая используется для аутентификации Устройства, защиты данных или проверки ответа на запрос аутентификации.
Приватная Собственность не подлежит разглашению за пределами доверенного вычислительного периметра SRM. Для реализации доверенного вычислительного периметра SRM следует использовать защищенный элемент (SE) или доверенную среду выполнения (TEE). На приватное содержимое можно ссылаться с помощью дескриптора; например, при использовании с подсистемой безопасного хранения.

#### 13.3.2.7 Дополнительные данные

Свойство optionaldata содержит информацию, которая предоставляется дополнительно, но облегчает управление ключами, масштабируемость или оптимизацию производительности.

#### 13.3.2.8 Период

Свойство периода определяет период действия учетных данных. Если срок действия не указан, срок действия учетных данных не определен. Устройства с ограничениями, которые не подразумевают возможности даты и времени, должны получать текущую информацию о дате и времени от своей CMS.

#### 13.3.2.9 Определение типа метода персонального обновления

CMS должна реализовывать методы обновления учетных данных, указанные в свойстве crms массива «oic.sec.creds» в Ресурсе «/oiс/sec/cred».
В таблице 36 определены значения «oic.sec.crmtype».

###### Таблица 36 - Определение значения свойства "oic.sec.crmtype"

| **V alue Type Na me** | **V  a lue Type URN** | **Applicable  Credential Type** | **Description**                                              |
| --------------------- | --------------------- | ------------------------------- | ------------------------------------------------------------ |
| Provisioning Service  | oic.sec. crm.pro      | All                             | CMS  инициирует повторную выдачу учетных данных при отправке. Сервер должен  удалить учетные данные с истекшим сроком действия, чтобы управлять ресурсами  хранилища. Свойство владельца ресурса относится к услугам по предоставлению  услуг. Сервер использует это средство "/oiс/ se c /  cred.rowneruuid", чтобы определить дополнительную службу управления  ключами, которая поддерживает этот метод обновления учетных данных. |
| Pre-shared   Key      | oic.sec. crm.psk      | [1]                             | Сервер выполняет обновление d-hoc ключа, инициируя  соединение DTLS с Устройством до истечения срока действия учетных данных,  используя базовый шифр Diffie-Hellman и текущий PSK. Новое значение DTLS  MasterSecret становится новым PSK. Сервер устанавливает новый срок действия.  Новое значение срока действия присваивается Устройству, которое обновляет срок  действия текущего удостоверения. Устройство, которое узнало, получает его  пульт, возвращая достаточный ответ, или задерживает обновление, повторно  включая ответ на ошибку. Сервер использует ресурс «/oiс/sec/cred.  Rowneruuid», чтобы идентифицировать службу управления ключами, которая  поддерживает его метод пересылки учетных данных. |
| Random PIN            | oic.sec. crm.rdp      | [16]                            | Сервер  выполняет новый ключ доступа, следуя подходу «oic.sec.crm.psk», но, кроме  того, генерирует случайное значение ПИН-кода, которое передается удаленному  устройству по внеполосному каналу. Устройство. Текущий PSK + PIN повторно  хешируется для формирования нового P SK ’, который используется с набором  шифров DTLS. I. e. PS K ’= SHA256 (P SK, P IN). Сервер использует ресурс  "/oiс/sec/cre d.rown eruuid" для определения службы управления  ключами, которая поддерживает его метод обновления учетных данных. |
| SKDC                  | oic.sec. crm.skdc     | [1,2,4,32]                      | Сервер выдает запрос на  получение билета для Устройства. Служба обновляет учетные данные, используя  информацию, содержащуюся в ответе на запрос билета. Сервер использует ресурс  "/ o ic /sec/cred.rowneruuid", чтобы идентифицировать сервер  управления ключами, который поддерживает его метод обновления учетных данных.  Сервер использует ресурс «/oiс/ se c / cred.rowneruuid» для идентификации  службы управления ключами, которая поддерживает его метод обновления учетных  данных. |
| PKCS10                | oic.sec. crm.pk10     | [8]                             | Сервер  выдает сообщение запроса сертификата PKCS # 10 для получения нового  сертификата. Сервер использует свой ресурс "/oiс/ se c /  cred.rowneruuid" для определения службы управления ключами, которая поддерживает  его новый метод. Сервер использует ресурс «/ o ic /sec/cred.rowneruuid»,  чтобы идентифицировать сервер управления ключом, который поддерживает его  метод обновления учетных данных. |

#### 13.3.3.4 Пароли

Форматирование пароля недоступно в этой версии документа.

### 13.3.4 Подробные сведения о методе обновления учетных данных

#### 13.3.4.1 Предоставление услуг

Владелец ресурса идентифицирует сервис инициализации. Если сервер детерминирует
учетные данные
требует обновления, а другие мета-хосты не применяются или выходят из строя, Сервер будет
запросить повторный

#### 13.3.4.2 Предварительный общий ключ

##### 13.3. 4.2. 1 Общий ключ Pre-Shared Key

В этом режиме текущий PSK используется для установки ключа Диффи-Хеллмана в DTLS. В
TLS_PRF используется как функция вывода ключа (KDF), которая создает новый (обновленный) PSK.
PSK = TLS_PRF (MasterSecret, сообщение, длина);

- Mast erSec ret - значение MasterSecret, полученное в результате взлома рук DTLS с использованием одного из
вышеперечисленные наборы шифрования.
- Сообщение - это объединение следующих значений:
- RM - Метод обновления - I. e. "oic.sec.crm.psk"
- Device ID_A - это строковое представление идентификатора устройства, предоставившего DTLS.
ClientHello.
- Device ID_B - это Устройство, отвечающее на сообщение DTLS ClientHello.
- Длина сообщения в байтах.
Бот-сервер и клиент используют PSK для обновления приватизированного ресурса "/oiс/sec/cred".
Если Сервер инициировал обновление учетных данных, он выбирает новый период действия. Сервер отправляет
выбранный срок действия для Клиента по вновь установленной сессии DTLS, чтобы он мог обновлять
соответствующий ресурс учетных данных для Сервера.

##### 13.3.4.2.2 Случайный PIN-код

В этом режиме текущий неистекший ПИН используется для генерации PSK в соответствии с IETF RFC 2898.
PSK используется во время обмена Диффи-Хеллмана для создания нового сеансового ключа. Сеансовый ключ следует использовать для переключения из режима PIN в режим PSK.
ПИН-код генерируется сервером случайным образом и передается Клиенту внеполосным способом. Используемый метод OOB выходит за рамки.
Псевдослучайная функция (PBKDF2), определенная IETF RFC 2898. PIN - это общее значение, используемое для генерации предварительного общего ключа. Предварительно согласованный ключ с аутентификацией по PIN-коду (PPSK) передается в набор шифрования DTLS, который принимает PSK.
PPSK = PBKDF2 (PRF, PIN, RM, идентификатор устройства, c, dkLen)
Функция PBKDF2 имеет следующие параметры:

- PRF - Использует DTLS PRF.
- PIN - общий для устройств.
- RM - Метод обновления - I. e. "oic.sec.crm.rdp"
- Device ID - UUID нового Устройства.
- c - Счетчик итераций, инициализированный до 1000, увеличивается при каждом использовании.
- dk Len - Желаемая длина производного PSK в октетах.

Бот-сервер и клиент используют PPSK для обновления PrivateData ресурса "/oiс/sec/cred" в свойстве. Если Сервер инициировал обновление учетных данных, он выбирает новый период действия. Сервер отправляет выбранный срок действия Клиенту в течение вновь установленного сеанса DTLS, чтобы он мог обновить соответствующий ресурс учетных данных для Сервера.

##### 13.3.4.2.3 SKDC

Сеанс DTLS открывается на сервере, где ресурс «/oiс/sec/cred» имеет значение свойства rowneruuid, которое соответствует CMS, которая реализует функциональность SKDC, и где учетные данные клиента поддерживают oic.sec.crm .skdc метод обновления учетных данных. Сообщение с запросом билета доставляется в CMS и в ответ возвращает запрос билета. Сервер обновляет или устанавливает Ресурс «/oiс/sec/cred», руководствуясь содержимым ответа на билет.

##### 13.3.4.2.4 PKCS 10

Сеанс DTLS открывается на сервере, где ресурс «/oiс/sec/cred» имеет значение свойства rowneruuid, которое соответствует CMS, поддерживающей oic.sec.crm. Обновление учетных данных pk10 с ходом. Сообщение в формате PKCS10 доставляется службе. После того, как сертификат обновления выпущен, CMS отправляет сертификат на сервер. Сервер обновляет или мгновенно обновляет Ресурс «/oiс/sec/cred», руководствуясь содержимым сертификата.

## 13.4 Список отозванных сертификатов

### 13.4.1 Определение ресурса CRL

Сертификаты устройств и частные ключи хранятся в кредитном ресурсе. CRL поддерживается и обновляется с помощью отдельного ресурса crl, который был недавно определен для ведения списка отзыва.
Ресурс «oic.r.crl» определен в таблице 39.

###### Таблица 39 - Определение источника «oic.r.crl»

## 13.5 Ресурсы ACL

### 13.5.1 Источники ACL Общие

Все ресурсы, размещенные на сервере, должны соответствовать политике ACL. Политики ACL могут быть выражены с использованием трех типов ресурсов ACL: «/oiс/sec/acl2», «/oiс/sec/amacl» и «/oic/sec/sacl». Запрашиваемый объект (например, deviceuuid клиента) доступ к Ресурсу должен быть аутентифицирован до применения проверки ACL. Ресурсы, доступные нескольким клиентам, могут быть сопоставлены с использованием подстановочного знака. Все ресурсы, доступные через незащищенную конечную точку связи, должны быть сопоставлены с использованием подстановочного знака.

### 13.5.2 Список управления доступом (ACL) OCF BNF определяет структуры ACL.

Структура ACL в нотации формы Бэкуса-Наура (BNF) определена в таблице 41:

###### Таблица 41 - Определение BNF ACL OCF

| < ACL>         | < ACE> {< ACE>}                                              |
| -------------- | ------------------------------------------------------------ |
| < ACE>         | < SubjectId> < ResourceRef>  < Permission> {< Validity>}     |
| < SubjectId>   | < DeviceId> \| < Wildcard> \|  < RoleId>                     |
| < DeviceId>    | < UUID>                                                      |
| < RoleId>      | < Character> \|  < RoleName>< Character>                     |
| < RoleName>    | "" \|  < Authority>< Character>                              |
| < Authority>   | < UUID>                                                      |
| < ResourceRef> | ' (' < OIC_LINK> {',' {< OIC_LINK>}  ')'                     |
| < Permission>  | ('C' \| '-') ('R' \| '-') ('U' \| '-') ('D' \| '-')  ('N' \| '-') |
| < Validity>    | < Period> {< Recurrence>}                                    |
| < Wildcard>    | ’*’                                                          |
| < URI>         | IETF RFC 3986                                                |
| < UUID>        | IETF RFC 4122                                                |
| < Period>      | [IETF RFC 5545 ](#_bookmark14)Period                         |
| < Recurrence>  | [IETF RFC 5545 ](#_bookmark14)Recurrence                     |
| < OIC_LINK>    | [ISO/IEC 30118-1:2018 ](#_bookmark2)defined in JSON Schema   |
| < Character>   | < Any UTF8 printable character, excluding  NUL>              |

Маркер < DeviceId> означает, что запрашивающая сторона должна обладать учетными данными, которые используют < UUID> в качестве идентификатора, чтобы сопоставить запрашивающую сторону с политикой < ACE>.
Маркер < RoleID> означает, что запрашивающая сторона должна иметь учетную запись роли с < Character> в качестве своей роли, чтобы соответствовать запрашивающей стороне с политикой < ACE>.
Маркер < Wildcard> «*» означает, что любой запросчик настроен на политику < ACE> с аутентификацией или без нее.
Когда < Subject Id> соответствует политике < ACE>, < ResourceRef> используется для привязки политики < ACE> к ресурсам.
Токен <OIC_LINK> содержит значения, используемые для запроса существования размещенных ресурсов.
Маркер < Permission> указывает привилегию, предоставленную политикой < ACE>, если соответствие < SubjectId> и < ResourceRef> не приводит к совпадению с пустым набором.
Разрешения определены в терминах CREATE («C»), RETRIEVE («R»), UPDATE («U»), DELETE («D»), NOTIFY («N») и NIL («-»). NIL устанавливается для символа разрешений, что означает, что соответствующее разрешение не предоставлено.
Результат сопоставления пустого набора по умолчанию соответствует условию, при котором права доступа не предоставляются.
Если маркер < Validity> существует, предоставленное < Permission> ограничено временем < Period>. < Validity> может быть дополнительно разделен на шаблон < Recurrence>, где доступ может быть предоставлен альтернативно и аннулирован в соответствии с шаблоном.

### 13.5.3 Ресурс ACL

Существует два типа ACL: «acl» - это список типа «ace» и «acl2» - это список типа «ace2». Устройство не должно размещать ресурс /acl.
ПРИМЕЧАНИЕ. Ресурс / acl определен для обратной совместимости и использования средствами Provisioning Tools и т. Д.

Чтобы предоставить интерфейс, который позволяет управлять элементами массива свойства "aclist2", связанного с ресурсом "/oiс/sec/acl2". Операции RETRIEVE, UPDATE и DELETE для ресурса «/oiс/sec/acl2» ДОЛЖНЫ вести себя следующим образом:

1. Зал RETRIEVE возвращает полное представление Ресурса.
2. ОБНОВЛЕНИЕ заменяет или добавляет свойства, включенные в представление, отправленное с запросом ОБНОВЛЕНИЕ, следующим образом:

   * Если представление UPDATE включает свойство массива, то: 
     * Поставляемые записи ACE с идентификатором aceid, который соответствует существующему идентификатору aceid, должны полностью заменить соответствующие записи ACE в существующем массиве aces2.
     * Поставляемые записи ACE без «aceid» должны быть добавлены к существующему массиву «aces2», а уникальный (для ресурса acl2) «aceid» должен быть создан и назначен новому ACE сервером. "Aceid" удаленного ACE не следует использовать повторно, чтобы улучшить детерминизм интерфейса и уменьшить возможность возникновения состояний гонки.
     * Поставляемые ACE с «aceid», не совпадающие с существующим «aceid», должны быть добавлены к существующему массиву «aces2» с использованием предоставленного «aceid».
       Строки в таблице 47 определяют свойства «oic.sec.acl2».
     * Таблица 47, соответствующая свойству массива «aclist2», определяет состояния устройства, в которых ОБНОВЛЕНИЕ свойства массива «aclist2» всегда отклоняется. Если устройство OCF находится в состоянии устройства, где режим доступа в этой строке содержит «R», тогда устройство OCF отклонит все ОБНОВЛЕНИЯ свойства массива «aclist2»
3. DELETE без параметров запроса удаляет весь массив «aces2», но не удаляет ресурс «oic.r.ace2».
4. УДАЛЕНИЕ с одним или несколькими параметрами запроса "aceid" должно удалить записи ACE с соответствующими идентификаторами aceid из массива "aces2".
   Строки в таблице 47 определяют свойства «oic.sec.acl2».
5. Таблица 47, соответствующая свойству массива "aclist2", определяет состояния устройства, в которых удаление всегда отклоняется. Если Устройство OCF находится в Состоянии Устройства, где Режим доступа в этой строке содержит "R", тогда Устройство OCF должно отклонить все УДАЛЕНИЯ.

ПРИМЕЧАНИЕ Использование ресурса «oic.r.acl2» операции DELETE не соответствует интерфейсу OCF, определенному в ISO / IEC 30118-1: 2018.
Оценка локального ресурса ACL завершается, когда все ресурсы ACL были запрошены, и для запрашивающего ресурса не может быть найдена запись для запрошенного ресурса - например, «/oiс/sec/acl», «/oiс/sec/sacl» и «/oiс/sec/amacl» не соответствуют теме и запрошенному ресурсу.
Возможно, у AMS есть политика ACL, удовлетворяющая запросу на доступ к ресурсам, но необходимый ACE не был предоставлен серверу. Сервер может открыть безопасное соединение с AMS, чтобы запросить подготовку ACL. Сервер может использовать критерий фильтра, который возвращает подмножество политики ACL AMS. AMS должен получить идентификатор серверного устройства, используя контекст безопасного соединения.
AMS поддерживает политику AMACL для серверов, которыми он управляет. Если сервер подключается к AMS для обработки ресурса «/oiс/sec/amacl». AMS должен соответствовать политике AMACL и возвращать свойство разрешения или ошибку, если совпадение не найдено.

Если запрошенный ресурс все еще не найден, сервер возвращает ошибку. Запрашивающий должен запросить Сервер, чтобы обнаружить настроенные службы AMS. Клиент должен связаться с AMS, чтобы запросить ресурс sacl ("/oiс/sec/sacl"). Этот тип запроса подразумевает выполнение следующих операций:

1.  Клиент: открытое безопасное подключение к AMS.
2. Клиент: RETRIEVE /oiс/sec/acl2? Deviceuuid = "XXX…", resources = "href"
3. AMS: создает ресурс "/oiс/sec/sacl", который подписан AMS, и возвращает его в ответ на команду RETRIEVE.
4. Клиент: ОБНОВЛЕНИЕ /oiс/sec/sacl [{… sacl…}]
5. Сервер: проверяет подпись SACL с использованием учетных данных AMS и устанавливает ресурс ACL, если он действителен.
6. Клиент: повторяет исходный запрос доступа к ресурсам. На этот раз новый ACL включен в локальную оценку ACL.

ACL, содержащийся в ресурсе «/oiс/sec/sacl», должен предоставлять долгосрочный доступ, удовлетворяющий повторяющиеся запросы ресурсов.
Ресурс «oic.r.acl» определен в таблице 42.

###### Таблица 42 - Определение ресурса "oic.r.acl"

| **Fixed URI** | **Resource  Type Title** | **Resource  Type ID (" rt" v a lue )** | **OCF**  **Interfaces** | **Description**                | **Related** **Func** **tiona** **l**  **Interaction** |
| ------------- | ------------------------ | -------------------------------------- | ----------------------- | ------------------------------ | ----------------------------------------------------- |
| /oic/sec/acl  | ACL                      | oic.r.acl                              | baseline                | Resource for   managing access | Security                                              |

Таблица 43 определяет свойства «oic.r.acl».

###### Таблица 43 - Свойства ресурса «oic.r.acl»

| **Property  Title** | **Property  Name** | **Value Type** | **Value  Rule** | **Mand atory** | **Access Mode** | **Device State** | **Description**                                              |
| ------------------- | ------------------ | -------------- | --------------- | -------------- | --------------- | ---------------- | ------------------------------------------------------------ |
| ACEList             | aclist             | oic.sec. ace   | N/A             | Yes            | N/A             | N/A              | Записи контроля доступа в источнике ACL. Это свойство содержит "ace", массив ресурсов "oic.sec.ace1" и "aces2", массив ресурсов "oic.sec.ace2". |
| N/A                 | N/A                | N/A            | N/A             | N/A            | R               | RESET            | Сервер должен установить заводские настройки по умолчанию.   |
|                     |                    |                |                 |                | RW              | RFOTM            | Устанавливается DOTS после успешного OTM                     |
|                     |                    |                |                 |                | RW              | RFPRO            | AMS (ссылка на свойство rowneruuid) должна обновлять записи aclist после установления защищенного сеанса с взаимной аутентификацией. Доступ к NCR запрещен. |
|                     |                    |                |                 |                | R               | RFNOP            | Доступ к NCR предоставляется после обнаружения ACE..         |
|                     |                    |                |                 |                | RW              | SRESET           | Точки DOTS (указанные в Свойстве devowneruid ресурса "/oiс/sec/doxm") должны оценивать целостность и могут обновлять записи списка ACL при установлении безопасного сеанса и повторной аутентификации Сервера и DOTS. |
| Resource OwnerID    | rowneruuid         | String         | uuid            | Yes            | N/A             | N/A              | Свойство владельца ресурса (rowneruuid) используется Сервером для ссылки на поставщика услуг, которому Сервер доверяет. Сервер должен подтвердить, что поставщик услуг авторизован для выполнения запрошенного действия. |
|                     |                    |                |                 |                | R               | RESET            | Сервер должен установить нулевое значение uuid (например, «00000000-0000-0000-0000-000000000000») |
|                     |                    |                |                 |                | RW              | RFOTM            | DOTS должна настроить свойство / aclrowneruuid, когда установлен успешный сеанс передачи владельца.. |
|                     |                    |                |                 |                | R               | RFPRO            | n /a                                                         |
|                     |                    |                |                 |                | R               | RFNOP            | n /a                                                         |
|                     |                    |                |                 |                | RW              | SRESET           | ТОЧКИ (указанные в свойстве / doxm devowneruuid или в свойстве / doxm rowneruuid) должны проверять и, при необходимости, обновлять Право владельца ресурса при установлении защищенного сеанса с взаимной аутентификацией. Если свойство rowneruuid не относится к допустимым точкам DOTS, Сервер должен перейти в состояние устройства RESET. |

Таблица 44 определяет свойства «oic.r.ace».

###### Таблица 44 - Свойства свойства "oic.r.ace"

| **Property Title** | **Property Na  me** | **Value Type**                          | **Value Rule** | **Access** **Mode** | **M a nda tory** | **Description**                                              |
| ------------------ | ------------------- | --------------------------------------- | -------------- | ------------------- | ---------------- | ------------------------------------------------------------ |
| Re  sourc es       | resources           | oic.oic-link                            | array          | RW                  | Yes              | The  application’s Resources to wh ich a se curity policy applies |
| Permission         | permission          | oic.sec.crudn typ e                     | bitmask        | RW                  | Yes              | B  i tmask e ncoding of CRUDN p e rm ission                  |
| Validity           | validity            | oic.sec.ace /definitions/time -interval | array          | RW                  | No               | An  array of a tuple o f period a n d  recurrence. Each item in th  i s a rray contains a st ring re p re sentin  g a period usi ng the  [IETF RFC 5545 ](#_bookmark14)P eriod,  and a st ring a rray re p re sentin  g a recurrence rule u si n g the [IETF RFC 5 545](#_bookmark14) Re cu rrence. |
| Subject  ID        | subectuuid          | String                                  | uui d, " *"    | RW                  | Yes              | A u u id that identifie s  the De vi ce to which this A CE a p p lies to or "*" for a n o  nymous a cc ess. |

В таблице 45 определены значения «oic.sec.crudntype».

###### Таблица 45 - Определение значения свойства "oic.sec.crudntype"

| **Value**          | **Access Policy** | **Description**             | **Remarks** Notes                                            |
| ------------------ | ----------------- | --------------------------- | ------------------------------------------------------------ |
| bx 0000, 0000 (0)  | No  permis sions  | No permissions              | N/A                                                          |
| bx 0000, 0001 (1)  | C                 | CREATE                      | N/A                                                          |
| bx 0000, 0001 (1)  | R                 | RETREIVE, OBSERVE, DISCOVER | Бит разрешения «R» охватывает как разрешение на чтение, так и разрешение на наблюдение. |
| bx 0000, 0010 (2)  | U                 | WRITE, UPDATE               | N/A                                                          |
| bx 0000, 1000 (8)  | D                 | DELETE                      | N/A                                                          |
| bx 0001, 0000 (16) | N                 | NOTIFY                      | Бит разрешения «N» игнорируется в OCF 1.0, поскольку «R» охватывает разрешение «Наблюдать». Это задокументировано для будущих версий |

Ресурс "oic.sec.acl2" определен в таблице 28.

###### Таблица 46 - Определение ресурса «oic.sec.acl2»

| Fixed  URI    | Resource Type Title | **Resource  Type ID (" rt" Value )** | **OCF**  **Interfaces** | **Description**              | **Related** **Func** **tiona** **l**  **Interaction** |
| ------------- | ------------------- | ------------------------------------ | ----------------------- | ---------------------------- | ----------------------------------------------------- |
| /oic/sec/acl2 | ACL2                | oic.r.acl2                           | baseline                | Resource for managing access | Security                                              |

Таблица 47 определяет свойства «oic.sec.acl2».

###### Таблица 47 - Свойства ресурса «oic.sec.acl2»

| **Property Name** | **Value  Type**       | **Mand atory** | **Device State** | **Access Mode** | **Description**                                              |
| ----------------- | --------------------- | -------------- | ---------------- | --------------- | ------------------------------------------------------------ |
| aclist2           | arrayof  oic.sec.ace2 | Yes            | N/A              | N/A             | Свойство aclist2 представляет собой массив записей ACE типа "oic.sec.ace2". Сервер использует этот список для управления доступом к своим локальным ресурсам. |
| N/ A              | N/ A                  | N/ A           | RESET            | R               | Server shall set to  manufacturer defaults.                  |
|                   |                       |                | RFOTM            | RW              | Set by DOTS a f ter su cc  essf ul OTM                       |
|                   |                       |                | RFPRO            | RW              | The  AMS (refe renced via rowneru uid p ro p erty) shall update the a clist e  ntries a fter m u tually a uthenticated se cure se ssi on is e sta b lish ed.  A ccess to NCRs is p rohibited. |
|                   |                       |                | RFNOP            | R               | A  cce ss to NCRs i s p ermitted after a m a t chin g ACE2 is found. |
|                   |                       |                | SRESET           | RW              | T he DOTS (re feren  ced via devowne ruuid P ro p erty of " /oic/sec/doxm Resource") sh  o u ld e valuate the integrity of and may u  p d ate aclist entries whe n a se cure se ssi on i s e sta blishe  d and the Server a  nd DOTS are a u the nticated . |
| rowneruuid        | uuid                  | Yes            | N/ A             | N/A             | Свойство владельца ресурса (rowneruuid) используется Сервером для ссылки на поставщика услуг, которому Сервер доверяет. Сервер должен подтвердить, что поставщик услуг уполномочен выполнить запрошенное действие. |
|                   |                       |                | RESET            | R               | S  e rve r shall se t to the nil uuid value (e.g. " 0 0 000000 -000 0-0  000-0000-000 000000 000" ) |
|                   |                       |                | RFOTM            | RW              | T he DOTS sh o uld configure  the rown eru uid P ro p erty of " /oic/sec/acl2" Resource whe n a  su cce ssf u l owner transf er session is e st ablished. |
|                   |                       |                | RFPRO            | R               | n /a                                                         |
|                   |                       |                | RFNOP            | R               | n /a                                                         |
|                   |                       |                | SRESET           | RW              | Точки DOTS (указанные в Свойстве devowneruuid или в свойстве rowneruuid ресурса "/ oic / sec / doxm") должны проверять и, при необходимости, обновлять Свойство владельца ресурса при установлении защищенного сеанса с взаимной аутентификацией. Если свойство rowneruuid не относится к допустимым точкам DOTS, сервер должен перейти в состояние устройства RESET.. |

Таблица 48 определяет свойства «oic.sec.ace2».

###### Таблица 48 - Определение типа данных «oic.sec.ace2».

| **Property Name** | **Value Type**                                        | Mand atory** | **Description**                                              |
| ----------------- | ----------------------------------------------------- | ------------ | ------------------------------------------------------------ |
| subject           | oic.sec.roletype, oic.sec.didtype,   oic.sec.conntype | Yes          | Клиент является субъектом ACE, когда совпадают роли, идентификатор устройства или тип подключения. |
| resources         | array of   oic.sec. ace2.resource-ref                 | Yes          | Ресурсы приложения, к которым применяется политика безопасности |
| permission        | oic.sec. crudntype.bitmask                            | Yes          | Кодирование битовой маски разрешения CRUDN                   |
| validity          | array of oic.sec.time- pattern                        | No           | Массив кортежа периода и повторения. Каждый элемент в этом массиве содержит строку, представляющую период с использованием периода IETF RFC 5545 Period, и массив строк, представляющий правило повторения с использованием IETF RFC 5545 Повторение. |
| aceid             | integer                                               | Yes          | aceid уникальна по отношению к записям массива в свойстве aclist2. |

Таблица 49 определяет свойства «oic.sec.ace2.resource-ref».

###### Таблица 49 - Определение типа данных «oic.sec.ace2. Resource -ref»

| **Property Na  me** | **Value Type** | **M a nda  tory** | **Description**                                              |
| ------------------- | -------------- | ----------------- | ------------------------------------------------------------ |
| href                | uri            | No                | A  URI re ferring to a Resource to which the containing ACE applies |
| wc                  | string         | No                | Refer to [Table 23](#_bookmark214).                          |

В таблице 50 определены значения «oic.sec.ace2.resource-ref».

###### Таблица 50 - Определение значения Свойство "oic.sec.conntype"

| **Property Na me** | **V alue Type** | **Value Rule**                       | **Description**                                              |
| ------------------ | --------------- | ------------------------------------ | ------------------------------------------------------------ |
| conntype           | string          | enum [ "auth-crypt",  "anon-clear" ] | Это свойство позволяет сопоставить ACE на основе типа защиты соединения или сообщения. |
|                    |                 | auth-crypt                           | ACE применяется, если клиент аутентифицирован, а сеанс передачи данных зашифрован и целостность защищена. |
|                    |                 | anon-clear                           | ACE применяется, если Клиент не аутентифицирован, а канал данных или сообщение не зашифрованы, но могут быть защищены целостностью |

Локальные ресурсы ACL предоставляют политику для точки принудительного доступа к ресурсам в экземпляре стека OCF. Платформа OCF обеспечивает доступ клиентов к ресурсам сервера. Он оценивает запрос субъекта с использованием политик, содержащихся в ресурсах ACL.

Ресурсы, указанные в политике ACL, могут быть полностью или частично квалифицированными. Полные ссылки на ресурсы включают идентификатор устройства в свойстве href, который идентифицирует удаленный сервер ресурсов, на котором размещен ресурс. Частично квалифицированные ссылки означают, что ресурс размещен на локальном сервере ресурсов. Если дана полностью квалифицированная ссылка на ресурс, то посредник, обеспечивающий доступ, должен иметь защищенный канал к серверу ресурсов, а сервер ресурсов должен проверить, что посредник авторизован действовать от его имени в качестве точки принудительного доступа к ресурсам.
Серверы ресурсов должны включать ссылки на устройства и ресурсы ACL, к которым будет применяться принудительный доступ. Однако логика обеспечения доступа не должна зависеть от этих ссылок для обработки управления доступом, поскольку доступ к ресурсам сервера уже будет предоставлен.
Локальные ресурсы ACL идентифицируют службу владельца ресурса, которая авторизована для создания и изменения этого ресурса. Это предотвращает непрерывную зависимость от какого-либо другого ресурса ACL.
Тем не менее, желательно предоставлять права доступа к ресурсам ACL с использованием ресурса ACL.

Запись ACE или ACE2 называется в настоящее время действительной, если период действия записи ACE или ACE2 включает время запроса. Срок действия в ACE или ACE2 может быть повторяющимся периодом времени (например, ежедневно с 1: 00-2: 00). Сопоставление ресурсов, указанных в запросе, со свойством ресурсов ACE или ACE2 определено в разделе 12.2. Например, они могут совпадать, если URI ресурса в запросе точно соответствует одной из ссылок на ресурсы в записях ACE или ACE2.

Запрос будет соответствовать ACE, если выполняется одно из следующих условий:
1) Свойство "deviceuuid", связанное с защищенным сеансом, совпадает с "subjectuuid" ACE; И Ресурс запроса принимает одно из «ресурсов» Свойство ACE; И ACE действителен в настоящее время.
2) Свойство ACE "subjectuuid" содержит подстановочный знак "*"; И ресурс запроса соответствует одному из свойств ресурсов ACE; И ACe в настоящее время действителен.
3) Когда аутентификация использует учетные данные с симметричным ключом;
И строка запроса полезной нагрузки CoAP в запросе определяет роль, которая связана с симметричными учетными данными текущего сеанса безопасности; И строка запроса полезной нагрузки CoAP указывает роль, которая содержится в свойстве «oic.r.cred.creds.rol eid» текущей защищенной сессии; И ресурс запроса соответствует одному из Свойств ресурсов ACE; И ТУЗ в настоящее время действителен.
Запрос будет соответствовать ACE2, если нарушено одно из следующих условий:
1) Свойство ACE2 «subject» имеет тип oic.sec.didty pe имеет значение UUID, которое соответствует свойству «devic euuid», связанному с безопасным сеансом; И ресурс запроса совпадает с одним из свойств ресурсов ACE2 oic.sec.ace2.resource-ref; И ACE2 в настоящее время действителен.
2) Свойство «субъект» ACE2 имеет тип oic.sec.conntype и имеет значение подстановочного знака, которое соответствует текущему установленному типу соединения; И ресурс запроса соответствует одному из свойств ресурсов ACE2 oic.sec.ace2.resource-ref; И ACE2 в настоящее время действителен.
3) При аутентификации клиента используются учетные данные сертификата; И одно из ролевых значений, содержащихся в ролевом сертификате, соответствует ролевому свойству ACE2 oic.sec.roletype;

И открытый ключ сертификата роли совпадает с открытым ключом сертификата, который используется для установления текущего безопасного сеанса;
И ресурс запроса совпадает с одним из элементов массива свойства ресурсов ACE2 oic.sec.ace2.resource-ref;
И ACE2 в настоящее время действителен.
4) При аутентификации клиента используются учетные данные сертификата;
И строка запроса полезной нагрузки CoAP в этом запросе указывает роль, которая является членом набора ролей, содержащихся в сертификате роли;
И значения rol eid, содержащиеся в сертификате роли, соответствуют свойству roleid ACE 2 oic.sec.roletype;
И открытый ключ сертификата роли совпадает с открытым ключом сертификата, который используется для установления текущего безопасного сеанса;
И ресурс запроса соответствует одному из свойств ресурсов ACE2 oic.sec.ace2.resource-ref;
И ACE2 в настоящее время действителен.
5) Когда аутентификация клиента использует учетные данные с симметричным ключом;
И одно из значений Rol eid, связанных с симметричным ключом учетных данных, используемым в защищенном сеансе, определяет свойство roleid типа ACE2 oic.sec.
И ресурс запроса совпадает с одним из элементов массива свойства ресурсов ACE2 oic.sec.ace2.resource-ref;
И ACE2 в настоящее время действителен.
6) Когда аутентификация клиента использует учетные данные с симметричным ключом;
И строка запроса полезной нагрузки CoAP указывает роль, которая содержится в свойстве «oic.r.cred.creds.rol eid» текущей защищенной сессии;
И строка запроса полезной нагрузки CoAP в запросе определяет роль, которая соответствует свойству "roleid" ACE2 oic.sec.roletype;
И ресурс запроса соответствует одному из элементов массива свойства "resources" ACE2 oic.sec.ace2.resource-ref;
И ACE2 в настоящее время действителен.
Запрос предоставляется, если ЛЮБОЙ из ACE "m atching" содержит разрешение разрешить запрос. В противном случае запрос отклоняется.
ACE не может явно запретить доступ к ресурсу. Следовательно, если одно Устройство с заданной ролью должно иметь несколько иные разрешения, чем другое Устройство с той же ролью, им должны быть предоставлены разные роли.
Сервер требуется для проверки того, что любой размещенный Ресурс имеет авторизованный доступ со стороны Клиента, запрашивающего доступ. Ресурс «/oiс/sec/acl2» совмещен с хостом ресурсов, поэтому обработка запроса ресурса должна выполняться безопасно и эффективно. См., Например, приложение А.

## 13.6 Ресурс ACL диспетчера доступа

Ресурс «oic.r.amacl» определен в таблице 51.

###### Таблица 51 - Определение ресурса «oic.r.a macl»

| **Fixed URI**  | **Re** **s ourc e Type  Title** | **Resource** **Type** **ID  (" rt" Value )** | **OCF**  **Interface  s** | **Description**                             | **Re la te d Functional  Interaction** |
| -------------- | ------------------------------- | -------------------------------------------- | ------------------------- | ------------------------------------------- | -------------------------------------- |
| /oic/sec/amacl | Managed ACL                     | oic.r.amacl                                  | baseline                  | Ресурс для управления безопасностью доступа | Security                               |

Таблица 52 определяет свойства «oic.r.amacl».

###### Таблица 52 - Свойства ресурса "oic.r.a ma cl"

| **Property Title** | **Property Na  me** | **Value  Type**              | **V alue Rule** | **Access** **Mode** | **Mandator y** | **Description**                             |
| ------------------ | ------------------- | ---------------------------- | --------------- | ------------------- | -------------- | ------------------------------------------- |
| Resources          | resources           | oic.sec.ace2. resource - ref | array           | RW                  | Yes            | Множественные ссылки на ресурсы этого хоста |

AMS следует использовать для централизации управления политикой доступа, но требует, чтобы серверы открывали соединение с AMS всякий раз, когда осуществляется доступ к указанным ресурсам. См., Например, А.2.

## 13.7 Ресурс подписанного ACL

Ресурс "oic.r.sacl" определен в таблице 53.



## 13.8 Источник статуса инициализации

Ресурс «/oiс/sec/pstat» управляет статусом инициализации устройства. Подготовка устройства должна быть направлена на клиента или на сервер. Подготовка, управляемая клиентом, зависит от клиентского устройства, чтобы определить, какие, как и когда Ресурсы сервера должны быть созданы и обновлены. Серверная инициализация полагается на то, что сервер будет искать инициализацию, когда того требуют условия. Серверная инициализация зависит от конфигурации свойства rowneruuid ресурсов «/oiс/sec/doxm», «/oiс/sec/cred» и «/oiс/sec/acl2» для определения идентификатора устройства доверенные сервисы DOTS, CMS и AMS соответственно. Кроме того, ресурс «/oiс/sec/cred» должен быть предоставлен при передаче прав собственности с учетными данными, необходимыми для открытия безопасного соединения с соответствующей службой поддержки.
Ресурс «oic.r.pstat» определен в таблице 56.

###### Таблица 56 - Определение ресурса «oic.r.pstat»

| **Fixed URI**  | **Resource  Type Title** | **Resource** **Type** **ID  (" rt" value )** | **OCF Interfaces** | **Description**                                         | **Related  Functional Interaction** |
| -------------- | ------------------------ | -------------------------------------------- | ------------------ | ------------------------------------------------------- | ----------------------------------- |
| /oic/sec/pstat | Provisioning Status      | oic.r.pstat                                  | baseline           | Ресурс для управления статусом инициализации устройства | Configuration                       |

###### Таблица 57 определяет свойства «oic.r.pstat».

| Property Title            | Property Name | Value Type       | Value Rule | Mand atory | Access Mode | Device State | Description                                                  |
| ------------------------- | ------------- | ---------------- | ---------- | ---------- | ----------- | ------------ | ------------------------------------------------------------ |
| Device   Onboarding State | dos           | oic.sec. dostype | N/ A       | Yes        | RW          |              | Device Onboarding State                                      |
| Is Device Operational     | isop          | Boolean          | T \|F      | Yes        | R           | RESET        | Сервер должен быть установлен на ЛОЖЬ                        |
|                           |               |                  |            |            | R           | RFOTM        | Сервер должен быть установлен на ЛОЖЬ                        |
|                           |               |                  |            |            | R           | RFPRO        | Сервер должен быть установлен на ЛОЖЬ                        |
|                           |               |                  |            |            | R           | RFNOP        | Server shall set to TRUE                                     |
|                           |               |                  |            |            | R           | SRESET       | Сервер должен быть установлен на ЛОЖЬ                        |
| Current Mode              | cm            | oic.sec. dpmtype | bitmask    | Yes        | R           |              | Current Mode                                                 |
| Target Mode               | tm            | oic.sec. dpmtype | bitmask    | Yes        | RW          |              | Target Mode                                                  |
| Operational Mode          | om            | oic.sec. pomtype | bitmask    | Yes        | R           | RESET        | Сервер должен быть установлен  производителем по умолчанию.  |
|                           |               |                  |            |            | RW          | RFOTM        | Устанавливается DOTS после успешного OTM                     |
|                           |               |                  |            |            | RW          | RFPRO        | Устанавливается CMS, AMS, DOTS после  успешной аутентификации |
|                           |               |                  |            |            | RW          | RFNOP        | Устанавливается CMS, AMS, DOTS после  успешной аутентификации |
|                           |               |                  |            |            | RW          | SRESET       | Set by DOTS.                                                 |
| Supported Mode            | sm            | oic.sec. pomtype | bitmask    | Yes        | R           | All states   | Поддерживаемые режимы работы сервисов  инициализации         |
| Device UUID               | device uuid   | String           | uuid       | Yes        | RW          | All states   | [DEPRECATED] UUID, который идентифицирует устройство, к которому применяется статус. |
| Resource Owner ID         | rowner uud    | String           | uuid       | Yes        | R           | RESET        | Сервер должен установить нулевое значение  uuid (например, «00000000-0000- 0000-0000-000000000000») |
|                           |               |                  |            |            | RW          | RFOTM        | DOTS должна сконфигурировать свойство  owneruuid, когда установлен успешный сеанс передачи владельца. |
|                           |               |                  |            |            | R           | RFPRO        | n /a                                                         |
|                           |               |                  |            |            | R           | RFNOP        | n /a                                                         |
|                           |               |                  |            |            | RW          | SRESET       | Точки DOTS (указанные в свойстве  devowneruuid ресурса "/ o ic /sec/doxm") должны проверять и, при  необходимости, обновлять Свойство владельца ресурса при установке взаимно  аутентифицированного безопасного сеанса. Если rowneruuid не относится к  действительным точкам DOTS, Сервер должен перейти в состояние RESET Device. |

Ресурс со статусом инициализации «/oiс/sec/pstat» используется для того, чтобы устройства могли выполнять самостоятельную инициализацию. Устройства знают о своем текущем состоянии конфигурации и цели целевой конфигурации. Когда существует различие между текущим и целевым статусом, Устройство должно проконсультироваться со свойством rowneruuid ресурса «/oiс/sec/cred», чтобы определить, существуют ли для него какие-либо подходящие сервисы обеспечения. Устройство должно запросить подготовку, если оно настроено для этого.

Свойство om ресурса "/oiс/sec/pstat" указывает ожидаемое поведение устройства в этих обстоятельствах.

Самостоятельная инициализация позволяет устройствам работать с большей автономностью, чтобы свести к минимуму
зависимость от центральной обеспечивающей власти, которая должна быть единственной точкой отказа в домене безопасности OCF.
Таблица 58 определяет свойства «/oiс/sec/dostype».

###### Таблица 58 - Свойства свойства "/oiс/sec/dostype"

| **Property Title**         | Property  Name** | **Value  Type** | **Value Rule**                                               | **Mand atory** | **Access Mode** | **De v ice S tate** | **Description**                                              |
| -------------------------- | ---------------- | --------------- | ------------------------------------------------------------ | -------------- | --------------- | ------------------- | ------------------------------------------------------------ |
| Device    Onboarding State | s                | UINT 16         | enum   (0 = RESET  , 1 = RFOT M ,  2 =  RFP RO,  3 = RFNOP ,  4 = SRESET | Y              | R               | RESET               | Устройство находится в состоянии полной перезагрузки.        |
|                            |                  |                 |                                                              |                | RW              | RFOTM               | Устанавливается DOTS после успешного OTM для RFPRO.          |
|                            |                  |                 |                                                              |                | RW              | RFPRO               | Устанавливается CMS, AMS, DOTS после успешной аутентификации |
|                            |                  |                 |                                                              |                | RW              | RFNOP               | Устанавливается CMS, AMS, DOTS после успешной аутентификации |
|                            |                  |                 |                                                              |                | RW              | SRESET              | Устанавливается CMS, AMS, DOTS после успешной аутентификации |
| Pending state              | p                | Boolean         | T  \| F                                                      | Y              | R               | All  states         | ИСТИНА (1) - состояние "s" завершается, пока все необходимые изменения в ресурсах устройства полностью завершены. ЛОЖЬ (0) - изменения состояния "s" завершены |

Во всех состояниях устройства:
- Аутентифицированный и авторизованный Клиент может изменить состояние устройства, обновив pstat.dos.s до желаемого значения. Допустимые состояния устройства определены на рисунке 27.
- Перед обновлением pstat.dos.s Клиент настраивает Устройство в соответствии с начальными условиями для нового состояния Устройства. Определения SVR определяют объект (клиент или сервер), который, как ожидается, будет выполнять конкретное изменение конфигурации SVR, чтобы соответствовать начальным условиям. После того, как Клиент настроил аспекты, за которые он отвечает, он может обновить файл pstat.dos.s. Затем Сервер вносит любые изменения, на которые он отвечает, включая обновление требуемых значений SVR, и устанавливает для pstat.dos.s новое значение.
- Свойство pstat.dos.p доступно только для чтения для всех клиентов.
- Сервер устанавливает для pstat.dos.p значение ИСТИНА перед началом процесса обновления pstat. dos.s и снова устанавливает значение FALSE, когда изменение pstat.dos.s завершено.

Любые запросы на обновление pstat.dos.s, пока pstat.dos.p имеет значение ИСТИНА, отклоняются.

Когда состояние устройства - RESET:

- Весь контент SVR удаляется и сбрасывается до заводских значений по умолчанию.
- Состояние устройства производителя по умолчанию - СБРОС.
- NCR сбрасываются до заводских значений по умолчанию.
- NCR недоступны.
- После успешной обработки RESET SRM переходит в RFOTM, задав свойство ресурса «/oiс/sec/dostype» для RFOTM.

Когда состояние устройства - RFOTM:
- NCR недоступны.
- Прежде чем OTM будет успешным, свойство deviceuuid ресурса "/oiс/sec/doxm" должно быть установлено на временное неповторяющееся значение, как определено в пунктах 13.2 и 13.16.
- До того, как OTM будет успешным, свойство ресурса "/oiс/sec/dostype" доступно только для чтения неаутентифицированным запросчикам.
- После успешного выполнения OTM свойство ресурса «/oiс/sec/dostype» читается и записывается авторизованными запрашивающими.
- Согласованный OC устройства используется для создания аутентифицированного сеанса, по которому DOTS направляет состояние устройства для передачи в RFPRO.
- Если аутентифицированный сеанс не может быть установлен, сеанс передачи прав собственности должен быть отключен, и SRM вернет состояние устройства в состояние СБРОС.
- Сеанс обмена сообщениями владельцев, особенно с произвольным вводом PIN-кода, не должен превышать 60 секунд, модуль SRM сообщает о сбое OTM, должен быть отключен и передают ионы в состояние СБРОС (/ pstat.dos.s = СБРОС).
- ТОЧКИ ОБНОВЛЯЮТ свойство devowneruuid в ресурсе / doxm до значения UUID, отличного от нуля. DOTS (или другой авторизованный клиент) может обновлять его несколько раз, пока находится в RFOTM. Его нельзя обновить в других состояниях устройства, за исключением случаев, когда состояние устройства возвращается в RFOTM через СБРОС.
- DOTS может иметь дополнительные задачи по подготовке к выполнению в RFOTM. Когда это сделано, ТОЧКИ ОБНОВЛЯЮТ свойство "владеть" в ресурсе / doxm на "истину".

Когда состояние устройства - RFPRO:
- Свойство s ресурса «/oiс/sec/dostype» доступно только для чтения неавторизованным запросчикам и для чтения-записи авторизованными запросчиками.
- NCR недоступны, за исключением Простых ресурсов настройки, если они поддерживаются.
- Сервер OCF может воссоздавать NCR.
- Уполномоченный клиент может предоставлять SVR по мере необходимости для нормального функционирования в RFNOP.
- Авторизованный клиент может выполнять проверки согласованности SVR, чтобы определить, какие h следует повторно инициализировать.
- Неспособность успешно предоставить SVR может вызвать изменение состояния на СБРОС. Например, если устройство уже перешло с SRESET, но проверки согласованности продолжают терпеть неудачу.
- Авторизованный Клиент устанавливает / pstat.dos.s = RFNOP.

При состоянии устройства RFNOP:
- Свойство / pstat.dos.s доступно только для чтения неавторизованным запросчикам и для чтения-записи авторизованными запросчиками.
- NCR, SVR и основные ресурсы доступны после нормальной обработки доступа.
- Авторизованный может перейти на RFPRO. Только владелец устройства может переключить ион на SRESET или RESET.

Когда состояние устройства - SRESET:

- NCR недоступны. Целостность NCR может вызывать подозрение, но SRM не пытается получить к ним доступ или ссылаться на них.

- Целостность SVR не гарантируется, но доступ к некоторым SVR Properties необходим. К ним относятся devowneruuid Свойство ресурса "/oiс/sec/doxm", "creds": [{…, {"subj ectuuid": <devowneruuid>},…}] Свойство "/oiс/sec/cred "Ресурс и s Свойство ресурса" /oiс/sec/dostype "ресурса" /oiс/sec/pstat ".
- Сертификатов, идентифицирующих и авторизующих владельца устройства, достаточно для воссоздания минималистичных ресурсов / cred и / doxm, что позволяет владельцу устройства управлять SRESET. Если SRM не может установить эти ресурсы, он перейдет в состояние RESET.
- Авторизованный Клиент выполняет проверку состояния SVR. Вызывающий может предоставить SVR по мере необходимости, чтобы гарантировать, что они доступны для продолжения предоставления в RFPRO или для нормального функционирования в RFNOP.
- Уполномоченный владелец устройства может избежать перехода в состояние RESET и RFOTM путем ОБНОВЛЕНИЯ свойства dos.s ресурса / pstat значениями RFPRO или RFNOP.
- ACL на SVR считаются недействительными. Авторизация доступа предоставляется в соответствии с привилегиями владельца устройства.
- SRM утверждает рабочий режим, управляемый клиентом (например, / pstat.om = CLIENT_DIRECTED).

Тип режима инициализации - это 16-битный запрос, в котором перечислены различные режимы инициализации устройства.
"{ProvisioningMode}" следует использовать в этом документе для ссылки на экземпляр режима обеспечения без выбора какого-либо конкретного значения.
"oic.sec.dpmtype" определено в Таблице 59.

###### Таблица 59 - Определение свойства «oic.sec.dpmtype»

| **Type  Name**           | **Type URN**     | **Description**                                              |
| ------------------------ | ---------------- | ------------------------------------------------------------ |
| Device Provisioning Mode | oic.sec. dpmtype | Режим инициализации устройства представляет собой 16-битную битовую маску, описывающую различные режимы инициализации. |

В таблицах 60 и 61 определены значения типа «oic.sec.dpm».

###### Таблица 60 - Значение Определение свойства "oic.sec.dpmtype" (Low -Byte)

| **Value**            | **Dev ice M ode**                    | **Description**                                              |
| -------------------- | ------------------------------------ | ------------------------------------------------------------ |
| bx 0000, 0001 (1)    | Deprecated                           |                                                              |
| bx 0000, 0010 (2)    | Deprecated                           |                                                              |
| bx 0000, 0100 (4)    | Deprecated                           |                                                              |
| bx 0000, 1000 (8)    | Deprecated                           |                                                              |
| bx 0001, 0000 (16)   | Deprecated                           |                                                              |
| bx 0010, 0000 (32)   | Deprecated                           |                                                              |
| bx 0100, 0000 (64)   | Initiate Software Version Validation | Подтверждение версии программного обеспечения запрошено / ожидается (1) Проверка версии программного обеспечения завершена (0) |
| bx 1000, 0000  (128) | Initiate Secure Software Update      | Запрошено / ожидает безопасное обновление программного обеспечения (1) Безопасное обновление программного обеспечения завершено (0) |

###### Таблица 61 - Значение Определение свойства «oic.sec.dpmtype» (старший байт)

| **Value**                       | **Device Mode** | **Description**        |
| ------------------------------- | --------------- | ---------------------- |
| bx  0000, 0000 –  bx 1111, 1111 | <  Reserved>    | Reserved for later use |

Тип режима работы инициализации - это 8-битная маска, в которой перечислены различные режимы работы инициализации.

"oic.sec.pomtype" определено в Таблице 62.

###### Таблица 62 - Определение свойства "oic.sec.pomtype"

| **Type  Name**                        | **Type URN**                                                 | **Description** |
| ------------------------------------- | ------------------------------------------------------------ | --------------- |
| Режим работы инициализации устройства | oic.sec.pomtype   Режим работы устройства - это 8-битная битовая маска, описывающая различные режимы работы. |                 |

В таблице 63 определены значения «oic.sec.pomtype».

###### Таблица 63 - Определение значения свойства "oic.sec.pomtype"

| **V a lue**                            | **Operation Mode**                                           | **Description**                                              |
| -------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| bx 0000, 0001 (1)                      | Серверно-ориентированное использование нескольких сервисов инициализации | Предоставление связанных услуг, замененных на разных устройствах. После этого предоставленное устройство должно установить несколько сеансов DTLS для обслуживания. Это условие существует, если бит 0 - ЛОЖЬ. |
| bx 000 0, 0010 (2)                     | Направлено на сервер с использованием единой службы подготовки. | Все услуги связаны с одним и тем же Устройством. Во время установки нескольких сеансов DTLS с помощью сервисов провидения, проверенное Устройство устанавливает только одно соединение DTLS с устройством. Это условие существует, когда бит 0 имеет значение ИСТИНА. |
| bx 0000, 0100 (4)                      | Подготовка, управляемая клиентом                             | Устройство поддерживает сервисный контроль над производственными операциями этого устройства. Это условие существует, когда бит 1 имеет значение ИСТИНА. Когда этот бит имеет значение FALSE, это устройство контролирует шаги инициализации. |
| bx 0000, 1000(8) –  bx 1000, 0000(128) | < Reserved>                                                  | Reserved for later use                                       |
| bx 1111, 11xx                          | < Reserved>                                                  | Reserved for later use                                       |







## 13.14 Виртуальные ресурсы безопасности (SVR) и политика доступа

SVR раскрывают свойства устройства, связанные с безопасностью.
Предоставление запросов доступа (RETRIEVE, UPDATE, DE LETE и т. Д.) Для этих SVR неаутентифицированным (анонимным) клиентам может создать проблемы с конфиденциальностью или безопасностью.

Например, когда встроенным статусом устройства является RFOTM, необходимо предоставлять запросы на ресурс «oic.r. doxm» анонимным запросам, чтобы устройство могло быть обнаружено и подключено OBT. Впоследствии, может быть предпочтительнее отклонять запросы ресурса «oic.r. doxm» анонимным запрашивающим, чтобы сохранить конфиденциальность.

## 13.15 SVR, обнаруживаемость и конечные точки OCF

Все внедренные SVR должны быть «обнаруживаемыми» (ссылка ISO / IE C 30118-1: 2018, параметр политики, пункт 7.8.2.1.2).
Все реализованные обнаруживаемые SVR должны открывать защищенную конечную точку OCF (например, CoAPS) (ссылка на ISO / IEC 30118-1: 2018, пункт 10).
Ресурс «/oiс/sec/doxm» должен предоставлять незащищенную конечную точку OCF (например, CoAP) в RFOTM (ссылка на ISO / IEC 30118-1: 2018, пункт 10).